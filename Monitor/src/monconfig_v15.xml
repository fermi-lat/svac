<monitoring>

  <inputList name="top"> 

    <!-- TEST variables -->
    <object> nACD </object>
    <object> Gem_elapsed </object>
    
    <!-- Time stamp -->
    <object> timestamp </object>

    
    <!-- Event classification information -->
    <object> condsummary </object>
    <object> LivetimeLast</object>
    <object> ElapsedLast</object>
    <object> DeadZoneLast</object>
    <object> DiscardedLast</object>
    <object> PrescaledLast</object>
     
    
    <!-- Tkr Variables -->
    
    <object> TkrTriggerTower </object>
    <object> TkrHitsTowerPlane </object>
    <object> IsTkrDigi_TowerPlane </object>
    <object> ToT_con0_TowerPlane  </object>
    <object> ToT_con1_TowerPlane  </object>

  </inputList>


  <outputList name="top">
    <!-- TEST variables -->
    <object>
      <name> nAcd  </name>
      <formula><![CDATA[   nACD ]]></formula>
      <cut><![CDATA[ 1 ]]></cut>
      <type> mean </type>
      <description> TEST parameter </description>
    </object>
    
    <object>
      <name> Gem_elapsed  </name>
      <formula><![CDATA[   Gem_elapsed ]]></formula>
      <cut><![CDATA[ 1 ]]></cut>
      <type> counterdiff </type>
      <description> TEST parameter </description>
    </object>
    <object>
      <name> alltriggers  </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[ condsummary==7 ]]></cut>
      <type> counter </type>
      <description> TEST parameter </description>
    </object>
    <object>
      <name> engine2 </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[ RFun::engine(condsummary,1852)==7 ]]></cut>
      <type> counter </type>
      <description> TEST parameter </description>
    </object>
    <object>
      <name> engine_Tower[16] </name>
      <formula><![CDATA[foreachengine: (RFun::engine(condsummary,1852)==engine) ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> TEST parameter </description>
    </object>

     <!-- ********************  Event classification information   *********************** -->
          
     <object>
      <name> Trigger_TKR </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[condsummary&2  ]]></cut>
      <type> counter </type>
      <description> Tkracker trigger (3 bilayers in a row) </description>
    </object>

     <object>
      <name> Trigger_CALLO </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[condsummary&4  ]]></cut>
      <type> counter </type>
      <description> CAL-LO trigger  </description>
    </object>

     <object>
      <name> Trigger_CALHI </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[condsummary&8  ]]></cut>
      <type> counter </type>
      <description> CAL-HI trigger  </description>
    </object>

      <object>
      <name> Trigger_CNO </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[condsummary&16  ]]></cut>
      <type> counter </type>
      <description> CNO trigger  </description>
    </object>

     <object>
      <name> Trigger_TRK_And_ROI </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[(condsummary&1) && (condsummary&2)]]></cut>
      <type> counter </type>
      <description> TKR trigger and ROI (mostly charge particles) </description>
    </object>

     <object>
      <name> Trigger_TRK_And_NotROI </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[(!condsummary&1) && (condsummary&2)]]></cut>
      <type> counter </type>
      <description> TKR trigger and not ROI (mostly non charge particles) </description>
    </object>

     <object>
      <name> Trigger_Periodic </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[condsummary&32]]></cut>
      <type> counter </type>
      <description> Periodic trigger </description>
    </object>

     <object>
      <name> Trigger_Solicited </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[condsummary&64]]></cut>
      <type> counter </type>
      <description> Solicited trigger </description>
    </object>

     <object>
      <name> Trigger_External </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[condsummary&128]]></cut>
      <type> counter </type>
      <description> External trigger </description>
    </object>

     <object>
      <name> Trigger_ANY </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[condsummary&255]]></cut>
      <type> counter </type>
      <description> Any of the trigger bits in condsummary word </description>
    </object>

     <object>
      <name> Trigger_ANYPhysics </name>
      <formula><![CDATA[ 1 ]]></formula>
      <cut><![CDATA[condsummary&15]]></cut>
      <type> counter </type>
      <description> Any non-artificially created trigger (i.e. bits [1-4]) in condsummary word  </description>
    </object>
      
     <object>
      <name> Livetime </name>
      <formula><![CDATA[ LivetimeLast ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counterdiff </type>
      <description> Livetime (in the time bin) in 50 ns ticks   </description>
    </object>

     <object>
      <name> Elapsed </name>
      <formula><![CDATA[ ElapsedLast ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counterdiff </type>
      <description> Elapsed time (in the time bin) in 50 ns ticks   </description>
    </object>

     <object>
      <name> DeadZone </name>
      <formula><![CDATA[ DeadZoneLast ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counterdiff </type>
      <description> Number of lost events  because they arrived in the 2-tick deadzone during this time bin</description>
    </object>

     <object>
      <name> Discarded </name>
      <formula><![CDATA[ DiscardedLast ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counterdiff </type>
      <description> Number of discarded events because they arrived in deadtime  during this time bin </description>
    </object>

     <object>
      <name> Prescaled </name>
      <formula><![CDATA[ PrescaledLast ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counterdiff </type>
      <description> Number of events prescaled away (in hardware) in this time bin </description>
    </object>

     

      <!-- ********************  Detector information   *********************** -->

      <!--  ______________  Tracker _______________ -->

     <object>
      <name> TkrTrigger_Tower[16] </name>
      <formula><![CDATA[ TkrTriggerTower ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of tracker triggers in [tower] during the specified time bin </description>
    </object>

    <object>
      <name> TkrHits </name>
      <formula><![CDATA[ RFun::loopovertowerANDtkrplanes(TkrHitsTowerPlane) ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of tkracker hits (all towers and planes included) in the specified time bin </description>
    </object>

    <object>
      <name> TkrHits_Tower[16] </name>
      <formula><![CDATA[ foreachtower: RFun::loopovertkrplanes(TkrHitsTowerPlane[tower]) ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of tracker hits in [tower] in the specified time bin </description>
    </object>

    <object>
      <name> TkrHits_TowerPlane[16][36] </name>
      <formula><![CDATA[ foreachtower: foreachtkrplane: TkrHitsTowerPlane[tower][tkrplane] ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of tracker hits in [tower][tkrplane] in the specified time bin </description>
    </object>

    <object>
      <name> TkrHitsWhenTkrDigiExists_TowerPlane[16][36] </name>
      <formula><![CDATA[ foreachtower: foreachtkrplane: (IsTkrDigi_TowerPlane[tower][tkrplane] > 0.5) && (TkrHitsTowerPlane[tower][tkrplane]) ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> mean </type>
      <description> Mean number of tracker hits per event in [tower][tkrplane]. Only events which have a TkrDigi associated to that [tower][tkrplane] are used in the average procedure </description>
    </object>
    

    <object>
      <name> ZeroTkrHitsCounter_TowerPlane[16][36] </name>
      <formula><![CDATA[ foreachtower: foreachtkrplane: TkrHitsTowerPlane[tower][tkrplane]==0 ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that there are ZERO strip hits in [tower][tkrplane] in the specified time bin </description>
    </object>

     <object>
      <name> TkrTriggerWithLessThan6Layers_Tower[16] </name>
      <formula><![CDATA[ foreachtower: TkrTriggerTower[tower]&&(RFun::getconsecutiveplaneshit(TkrHitsTowerPlane[tower])<6) ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that, in [tower], there was a tracker trigger and the number of consecutive tracker planes hit is less than 6 </description>
    </object>

     <object>
      <name> ConsecutivePlanesHit_Tower[16] </name>
      <formula><![CDATA[ foreachtower: TkrTriggerTower[tower]&&(RFun::getconsecutiveplaneshit(TkrHitsTowerPlane[tower])) ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> mean </type>
      <description> Mean number of consecutive tracker planes hit in [tower] per event triggereing that [tower] </description>
    </object>

     <object>
      <name> EmptyTowers_Tower[16] </name>
      <formula><![CDATA[runonce: RFun::getemptytowers(TkrTriggerTower)# foreachtower: runonceformula[tower] > 0.5 ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times [tower] did not trigger and was not close to a tower that triggered </description>
    </object>

     <object>
      <name> HitsInEmptyTower_Tower[16] </name>
      <formula><![CDATA[runonce: RFun::getemptytowers(TkrTriggerTower)# foreachtower: RFun::gethitsinemptytower(runonceformula[tower],TkrHitsTowerPlane[tower]) ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of hits when the tower was empty </description>
    </object>

     <object>
      <name> TkrDigiCounter_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane : IsTkrDigi_TowerPlane[tower][tkrplane] > 0.5 ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of TkrDigi objects in each [tower][tkrplane] during the specified time bin </description>
    </object>

     <object>
      <name> TkrDigiCounter_Tower[16] </name>
      <formula><![CDATA[foreachtower: RFun::loopovertkrplanes(IsTkrDigi_TowerPlane[tower]) ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of TkrDigi objects in each [tower] during the specified time bin </description>
    </object>

     <object>
      <name> TkrDigiCounter </name>
      <formula><![CDATA[ RFun::loopovertowerANDtkrplanes(IsTkrDigi_TowerPlane) ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of TkrDigis (all towers and planes included) accumulated in the specified time bin </description>
    </object>

     <object>
      <name> ToT_con0_250_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: ToT_con0_TowerPlane[tower][tkrplane]==250 ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that ToT==250 (saturation) in controller 0 in [tower][trkplane] in the specified time bin </description>
    </object>

     <object>
      <name> ToT_con1_250_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: ToT_con1_TowerPlane[tower][tkrplane]==250 ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that ToT==250 (saturation) in controller 1 in [tower][trkplane] in the specified time bin </description>
    </object>

     <object>
      <name> ToT_250_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: ToT_con0_TowerPlane[tower][tkrplane]==250 || ToT_con1_TowerPlane[tower][tkrplane]==250]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that ToT==250 in either controller 0 or controller 1 in [tower][trkplane] in the specified time bin </description>
    </object>

    <object>
      <name> ToT_con0_0_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: IsTkrDigi_TowerPlane[tower][tkrplane]>0.5 && ToT_con0_TowerPlane[tower][tkrplane]==0 ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that, existing TkrDigi, ToT==0 in controller 0 in [tower][trkplane] during the specified time bin </description>
    </object>

     <object>
      <name> ToT_con1_0_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: IsTkrDigi_TowerPlane[tower][tkrplane]>0.5 && ToT_con1_TowerPlane[tower][tkrplane]==0 ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that, existing TkrDigi, ToT==0 in controller 1 in [tower][trkplane] during the specified time bin </description>
    </object>

     <object>
      <name> ToT_0_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: IsTkrDigi_TowerPlane[tower][tkrplane]>0.5 && ToT_con0_TowerPlane[tower][tkrplane]==0 && ToT_con1_TowerPlane[tower][tkrplane]==0 ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that, existing TkrDigi, ToT==0 in both controller 0 and controller 1 in [tower][trkplane] during the specified time bin </description>
    </object>

    <object>
      <name> ToT_con0_Greater250_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: ToT_con0_TowerPlane[tower][tkrplane]>250 ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that, ToT>250 (overlapped trigger) in controller 0 in [tower][trkplane] during the specified time bin </description>
    </object>

    <object>
      <name> ToT_con1_Greater250_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: ToT_con1_TowerPlane[tower][tkrplane]>250 ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that, ToT>250 (overlapped trigger) in controller 1 in [tower][trkplane] during the specified time bin </description>
    </object>

     <object>
      <name> ToT_Greater250_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: ToT_con0_TowerPlane[tower][tkrplane]>250 || ToT_con1_TowerPlane[tower][tkrplane]>250]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that, ToT>250 (overlapped trigger) either in controller 0 or controller 1 in [tower][trkplane] during the specified time bin </description>
    </object>

    <object>
      <name> ToT_con0_TruncMean_1_249_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: ToT_con0_TowerPlane[tower][tkrplane] ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> truncatedmean[1,249] </type>
      <description> Truncated mean (only range [1,249] is used) ToT value per event in controller 0 in [tower][trkplane] </description>
    </object>

    <object>
      <name> ToT_con1_TruncMean_1_249_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: ToT_con1_TowerPlane[tower][tkrplane] ]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> truncatedmean[1,249] </type>
      <description> Truncated mean (only range [1,249] is used) ToT value per event in controller 1 in [tower][trkplane] </description>
    </object>


     <object>
      <name> ToT_0_WhenTkrHitsExist_TowerPlane[16][36] </name>
      <formula><![CDATA[foreachtower: foreachtkrplane: (IsTkrDigi_TowerPlane[tower][tkrplane]>0.5) && (ToT_con0_TowerPlane[tower][tkrplane]==0) && (ToT_con1_TowerPlane[tower][tkrplane]==0) && (TkrHitsTowerPlane[tower][tkrplane]>0)]]></formula>
      <cut><![CDATA[ ]]></cut>
      <type> counter </type>
      <description> Number of times that, existing TkrDigi and having at least one hit, ToT==0 in both controller 0 and controller 1 in [tower][trkplane] during the specified time bin </description>
    </object>

  </outputList>

  <eventCut><![CDATA[ condsummary&2 || condsummary&4 || condsummary&8 || condsummary&16 ]]></eventCut>
  <timestamp> timestamp </timestamp>
</monitoring>
